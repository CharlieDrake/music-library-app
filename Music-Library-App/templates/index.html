<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Music Library</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <link rel="manifest" href="/manifest.json">
    </head>

    <body>
        <!-- Loading Indicator -->
        <div id="loadingIndicator">
            <div class="logo">
                <i class="fas fa-music"></i>
                <span>MusicLibrary Pro</span>
            </div>
            <div class="spinner"></div>
            <p>Loading application...</p>
        </div>

        <!-- No JavaScript Warning -->
        <noscript>
            <div class="nojs-warning">
                <h1>JavaScript Required</h1>
                <p>This music library application requires JavaScript to function.</p>
                <p>Please enable JavaScript in your browser settings and refresh the page.</p>
            </div>
        </noscript>

        <div class="container">
            <header>
                <div class="logo">
                    <i class="fas fa-music"></i>
                    <span>MusicLibrary Pro</span>
                </div>
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="nav-links" id="navLinks">
                    <button class="nav-btn" id="uploadBtn">
                        <i class="fas fa-upload"></i> Upload Music
                    </button>
                    <button class="nav-btn" id="createPlaylistBtn">
                        <i class="fas fa-plus-circle"></i> Create Playlist
                    </button>
                    <button class="nav-btn" id="refreshBtn">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
            </header>

            <main class="main-content">
                <aside class="sidebar">
                    <h2 class="section-title">
                        <i class="fas fa-list"></i> Your Playlists
                    </h2>
                    <ul class="playlist-list" id="playlistList">
                        <!-- Playlists loaded dynamically -->
                    </ul>

                    <div class="library-info">
                        <h3 class="section-title">
                            <i class="fas fa-info-circle"></i> Library Info
                        </h3>
                        <div class="info-item">
                            <span>Total Songs:</span>
                            <span id="totalSongs">0</span>
                        </div>
                        <div class="info-item">
                            <span>Total Playlists:</span>
                            <span id="totalPlaylists">0</span>
                        </div>
                        <div class="info-item">
                            <span>Storage Used:</span>
                            <span id="storageUsed">0 B</span>
                        </div>
                    </div>

                    <div class="sort-options">
                        <h3 class="section-title">
                            <i class="fas fa-sort"></i> Sort By
                        </h3>
                        <select id="sortSelect" class="sort-select">
                            <option value="title">Title (A-Z)</option>
                            <option value="artist">Artist (A-Z)</option>
                            <option value="album">Album (A-Z)</option>
                            <option value="uploaded_at">Recently Added</option>
                            <option value="play_count">Most Played</option>
                        </select>
                    </div>
                </aside>

                <section class="player-section">
                    <div class="player-header">
                        <h1 class="player-title" id="currentPlaylist">All Songs</h1>
                        <button class="upload-btn" id="uploadBtn2">
                            <i class="fas fa-upload"></i> Upload Music
                        </button>
                    </div>

                    <div class="player-container">
                        <div class="now-playing">
                            <div class="album-art" id="albumArt">
                                <i class="fas fa-music"></i>
                            </div>
                            <div class="song-info">
                                <h3 id="currentSongTitle">No song selected</h3>
                                <p id="currentSongArtist">Select a song to play</p>
                                <div class="song-meta">
                                    <span id="currentSongAlbum"></span>
                                    <span id="currentSongDuration"></span>
                                    <span id="currentSongPlays">0 plays</span>
                                </div>
                            </div>
                        </div>

                        <div class="progress-container">
                            <div class="progress-bar" id="progressBar">
                                <div class="progress" id="progress"></div>
                            </div>
                            <div class="progress-info">
                                <span id="currentTime">0:00</span>
                                <span id="duration">0:00</span>
                            </div>
                        </div>

                        <div class="player-controls">
                            <button class="control-btn" id="prevBtn">
                                <i class="fas fa-step-backward"></i>
                            </button>
                            <button class="control-btn" id="shuffleBtn">
                                <i class="fas fa-random"></i>
                            </button>
                            <button class="control-btn play-pause" id="playPauseBtn">
                                <i class="fas fa-play" id="playIcon"></i>
                            </button>
                            <button class="control-btn" id="repeatBtn">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="control-btn" id="nextBtn">
                                <i class="fas fa-step-forward"></i>
                            </button>
                            <div class="volume-control">
                                <i class="fas fa-volume-up"></i>
                                <input type="range" id="volumeSlider" min="0" max="100" value="80">
                            </div>
                        </div>
                    </div>

                    <div class="songs-list">
                        <div class="songs-header">
                            <h2 class="songs-title" id="songsListTitle">All Songs</h2>
                            <div class="search-container">
                                <input type="text" class="search-box" id="searchBox" placeholder="Search songs...">
                                <button class="search-btn" id="searchBtn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>

                        <div class="table-container">
                            <table class="songs-table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Title</th>
                                        <th>Artist</th>
                                        <th>Album</th>
                                        <th>Duration</th>
                                        <th>Plays</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="songsTableBody">
                                    <!-- Songs loaded dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </main>
        </div>

        <!-- Modals -->
        <div class="modal" id="uploadModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Upload Music</h2>
                    <button class="close-modal" id="closeUploadModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form id="uploadForm">
                    <div class="form-group">
                        <label for="fileInput">Select audio files</label>
                        <input type="file" id="fileInput" class="form-control file-input" accept=".mp3,.mp4,.m4a,.wav,.flac,.ogg" multiple>
                        <p class="file-info">Supported formats: MP3, MP4, M4A, WAV, FLAC, OGG</p>
                        <p class="file-info">Max file size: 200MB</p>
                    </div>
                    <div class="form-group">
                        <label for="playlistSelect">Add to playlist (optional)</label>
                        <select id="playlistSelect" class="form-control">
                            <option value="">Select a playlist</option>
                        </select>
                    </div>
                    <div class="upload-progress" id="uploadProgress">
                        <div class="progress-bar">
                            <div class="progress" id="uploadProgressBar"></div>
                        </div>
                        <div class="progress-text" id="uploadProgressText">0%</div>
                    </div>
                    <button type="submit" class="btn" id="uploadSubmitBtn">
                        <i class="fas fa-upload"></i> Upload Files
                    </button>
                </form>
            </div>
        </div>

        <div class="modal" id="playlistModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Create New Playlist</h2>
                    <button class="close-modal" id="closePlaylistModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form id="playlistForm">
                    <div class="form-group">
                        <label for="playlistName">Playlist Name</label>
                        <input type="text" id="playlistName" class="form-control" placeholder="My Awesome Playlist" required>
                    </div>
                    <div class="form-group">
                        <label for="playlistDescription">Description (optional)</label>
                        <textarea id="playlistDescription" class="form-control" rows="3" placeholder="What's this playlist about?"></textarea>
                    </div>
                    <button type="submit" class="btn">
                        <i class="fas fa-plus-circle"></i> Create Playlist
                    </button>
                </form>
            </div>
        </div>

        <div class="modal" id="addToPlaylistModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Add to Playlist</h2>
                    <button class="close-modal" id="closeAddToPlaylistModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="form-group">
                    <p>Select playlist to add this song to:</p>
                    <select id="addToPlaylistSelect" class="form-control">
                        <option value="">Select a playlist</option>
                    </select>
                </div>
                <div class="form-group">
                    <button type="button" class="btn" id="confirmAddToPlaylist">
                        <i class="fas fa-plus"></i> Add to Playlist
                    </button>
                    <button type="button" class="btn btn-secondary" id="cancelAddToPlaylist">
                        Cancel
                    </button>
                </div>
            </div>
        </div>

        <!-- Notification -->
        <div class="notification" id="notification">
            <i class="fas fa-check-circle"></i>
            <span id="notificationText">Operation completed successfully!</span>
        </div>

        <!-- Audio Element -->
        <audio id="audioPlayer"></audio>

        <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    </body>

</html>
